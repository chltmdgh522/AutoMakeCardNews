<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>A.M.C.N</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/style_em.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="/logo/logo2.png" type="image/x-icon">
    <!-- Google Fonts 링크 추가 -->
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Nanum+Gothic&family=Noto+Sans+KR&family=Gugi&family=Black+Han+Sans&family=Gamja+Flower&family=Dokdo&family=Sunflower:wght@300;500;700&family=Poor+Story&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/cardInformation.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css">
    <script src="https://kit.fontawesome.com/097a6f4f17.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">
    <style>
        #save5 {
            width: 2rem;
            height: 2rem;
            font-size: 1.2rem;
            color: white;
            cursor: pointer;
            background-color: rgba(23, 23, 23, 1);
            border-radius: 0.2rem; /* 둥근 모서리 */
            transition: transform ease-in-out 0.1s;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Hover 효과 추가 */
        #save5:hover {
            transform: scale(1.3);
            z-index: 1;
        }

        label[for='file'] {
            width: 2rem;
            height: 2rem;
            font-size: 1.2rem;
            color: white;
            cursor: pointer;
            background-color: rgba(23, 23, 23, 1);
            border-radius: 0.2rem; /* 둥근 모서리 */
            transition: transform ease-in-out 0.1s;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        label[for="file"]:hover {
            transform: scale(1.3);
            z-index: 1;
        }

        #popup5 {
            display: none;
            position: fixed;
            left: 800px;
            width: 120%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .popup-content5 {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 300px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .popup-content5 h2 {
            margin-top: 0;
        }

        .popup-content5 label {
            display: block;
            margin-bottom: 10px;
        }

        .button-group5 {
            margin-top: 20px;
        }

        .btn {
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
            color: white;
            margin-right: 10px;
        }

        .download-btn5 {
            background-color: #007bff;
        }

        .cancel-btn5 {
            background-color: #f44336;
        }

        .close-btn5 {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 30px;
            cursor: pointer;
            font-weight : bold;
        }

        .center-block {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column; /* 세로로 정렬 */
            margin: 0; /* 기본 여백 제거 */
        }

        #time, .center-block > div {
            margin: 10px; /* 위쪽 두 div 간격 없애기 */
            padding: 0; /* 필요 시 패딩도 제거 */
        }
        .main_container{
            width: 500px;
            height: 400px;
        }

        title {
            background-color: black;
        }

        #canvas2 {
            background-color: whitesmoke;
        }

        /* 오버레이 스타일 */
        .overlay-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            flex-direction: column; /* 수직 정렬 */
            justify-content: center; /* 수평 중앙 정렬 */
            align-items: center; /* 수직 중앙 정렬 */
            color: white;
            font-size: 30px;
        }

        #time {
            color: red;
            font-weight: bold;
            font-size: 40px; /* 타이머 크기 */
            margin-bottom: 10px; /* 타이머와 문구 사이 간격 */
        }
    </style>

</head>

<body>
<header id="header">
    <a href="/" style="text-decoration: none">
        <!--    <img src="/logo/AMCNicon.png" alt="">-->
        <p id="yamlogo">AMCN</p>
    </a>
</header>

<div id="main_display">
    <aside class="tools">
        <ul>
            <li>
                <button id="drawing" class="tool">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" style="width: 30px; height: 30px; vertical-align: middle;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42" />
                    </svg>
                    <span class="tooltip">Pen</span>
                </button>
            </li>

            <li>
                <button id="square" class="tool">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" style="width: 40px; height: 40px; vertical-align: middle; margin-left: -5px;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z" />
                    </svg>
                    <span class="tooltip">Square</span>
                </button>
            </li>
            <li>
                <button id="fill_square" class="tool">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6" style="width: 40px; height: 40px; vertical-align: middle; margin-left: -5px;">
                        <path fill-rule="evenodd" d="M4.5 7.5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-9a3 3 0 0 1-3-3v-9Z" clip-rule="evenodd" />
                    </svg>
                    <span class="tooltip">fill_square</span>
                </button>
            </li>

            <li>
                <button id="filter" class="tool">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" />
                    </svg>
                    <span class="tooltip">Filter</span>
                </button>
            </li>
            <li>
                <button id="reset" class="tool">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                    </svg>
                    <span class="tooltip">Delete</span>
                </button>
            </li>
            <li>
                <button id="info" class="tool">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" style="width: 30px; height: 30px; vertical-align: middle;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                    </svg>
                    <span class="tooltip">Info</span>
                </button>
            </li>
        </ul>
        <li>
            <button id="category" class="tool">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" style="width: 30px; height: 30px; vertical-align: middle;">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
                </svg>
                <span class="tooltip">Category(post)</span>
            </button>

            <div id="popup" class="popup">
                <form id="imageForm" method="post" enctype="multipart/form-data"
                      th:object="${cardNews}">

                    <input type="hidden" id="imageData" name="imageData">
                    <h3 style="font-family: 'Noto Sans KR', sans-serif; font-weight:bold;">
                        <i class="fas fa-paper-plane" style="margin-right: 8px;" title="게시하기"></i> <!-- 게시 아이콘 -->
                        카드 뉴스 게시
                    </h3>
                    <div th:if="${#fields.hasGlobalErrors()}">
                        <p class="field-error" th:each="err : ${#fields.globalErrors()}"
                           th:text="${err}">전체 오류 메시지</p>
                    </div>
                    <div class="category">
                        <label><input type="radio" th:field="*{category}" name="category" value="IT" th:checked
                                      required> IT</label>
                        <label><input type="radio" th:field="*{category}" name="category" value="과학" required>
                            과학</label>
                        <label><input type="radio" th:field="*{category}" name="category" value="스포츠" required>
                            스포츠</label>
                        <label><input type="radio" th:field="*{category}" name="category" value="경제" required>
                            경제</label>
                        <label><input type="radio" th:field="*{category}" name="category" value="예술" required>
                            예술</label>
                    </div>
                    <div>
                        <label for="title">제목</label>
                        <input type="text" th:field="*{title}" id="title" name="title"

                               required>
                    </div>
                    <div>
                        <label for="content">내용</label>
                        <textarea id="content" name="content" th:field="*{content}"
                                  rows="4"
                                  required></textarea>
                    </div>
                    <button type="button" id="postButton"
                            onclick="saveImage()">게시
                    </button>
                </form>
            </div>
        </li>

        <ul class='files'>
            <li>
                <!-- 파일 선택 input -->
                <input type="file" accept="image/*" id="file" style="display: none;" />
            </li>
            <li>
                <!-- File 버튼: 버튼으로 변경 및 클래스 적용 -->
                <button onclick="document.getElementById('file').click()" class="tool" style="cursor: pointer;">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" style="width: 30px; height: 30px; vertical-align: middle;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" />
                    </svg>
                    <span class="tooltip">File</span>
                </button>
            </li>
            <li>
                <!-- Save 버튼: 같은 스타일 적용 -->
                <button id="save5" class="tool" style="cursor: pointer;">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" style="width: 30px; height: 30px; vertical-align: middle;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9.75v6.75m0 0-3-3m3 3 3-3m-8.25 6a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z" />
                    </svg>
                    <span class="tooltip">Save</span>
                </button>
            </li>
        </ul>

    </aside>

    <main>
        <canvas id="imageCanvas"></canvas>
        <button id="speakerButton" class="speaker-btn">🔊</button>
    </main>

    <aside class="tools_sett">
        <div class="container" style="margin-bottom: -138px;">
            <input type="color" id="text_color"/>
            <label for="text_color" class="color_tool">색상</label>
            <input type="color" id="background_color" value="#ffffff"/>
            <label for="background_color" class="color_tool">배경색</label>
        </div>
        <div class='ranges' style="margin-bottom: -55px;">
            <div id="canvas_range">
                <input type="text" id="canvas_width" value="750">
                X
                <input type="text" id="canvas_height" value="750">
                <label for="canvas_range" class="range_tool">Canvas</label>
            </div>
            <div id="size_box" style="display: none;">
                <input type="range" id="line_width" min="1" max="10" value="5" step="0.1"/>
                <label for="line_width" class="range_tool">사이즈</label>
            </div>
        </div>
        <div>
            <div class="styled-section">
                <div class="input-group">
                    <input name="imageCreate" id="imageCreate" class="styled-input" placeholder="ex) 광화문 관련 카드뉴스 만들어줘"/>
                    <button id="imageButton" class="styled-button">이미지 생성</button>
                </div>
                <div class="text-button-group" style="margin-top: 75px;">
                    <button id="textbutton" class="styled-button">텍스트 추가</button>
                </div>
            </div>

            <div id="popup1" class="popup1">
                <h3 style="font-family: 'Noto Sans KR', sans-serif;">
                    <i class="fa fa-text-width" aria-hidden="true" style="margin-right: 5px;"></i> 텍스트 추가
                </h3>
                <textarea id="textInput" placeholder="텍스트 입력"></textarea>
                <input type="color" id="textColorPicker" value="#000000" style="width: 300px;">
                <input type="number" id="textSizeInput" placeholder="텍스트 크기" min="10" max="100" value="35">
                <select id="fontWeightSelect">
                    <option value="bold">Bold</option>
                    <option value="normal">Normal</option>
                </select>
                <select id="fontFamilySelect">
                    <option value="Jua">Jua</option>
                    <option value="Nanum Gothic">Nanum Gothic</option>
                    <option value="Noto Sans KR">Noto Sans KR</option>
                    <option value="Gugi">Gugi</option>
                    <option value="Noto Sans KR">Noto Sans KR</option>
                    <option value="Black Han Sans">Black Han Sans</option>
                    <option value="Gamja Flower">Gamja Flower</option>
                    <option value="Dokdo">Dokdo</option>
                    <option value="Sunflower">Sunflower</option>
                    <option value="Poor Story">Poor Story</option>
                </select>
                <button id="addTexTAIButton2" style="background-color: red; margin-bottom: 5px;">AI 문구 생성</button>
                <button id="addTextButton">텍스트 추가</button>
            </div>
        </div>
        <!--        <input type="file" id="loadJsonFile" accept="application/json">-->
        <!--        <button id="loadJson">Load from JSON</button>-->
        <!--        <button id="saveJson">Save as JSON</button>-->
    </aside>
</div>

<!-- 텍스트 편집 모달 -->
<div id="textEditPopup" class="popup2">
    <h3 style="font-family: 'Noto Sans KR', sans-serif;">
        <i class="fa fa-text-width" aria-hidden="true" style="margin-right: 5px;"></i> 텍스트 업데이트
    </h3>
    <div style="margin-bottom: 10px;">

        <textarea id="popupTextInput"></textarea>
    </div>
    <div style="margin-bottom: 10px;">
        <input type="color" id="popupTextColorPicker" style="width: 300px;">
    </div>
    <div style="margin-bottom: 10px;">
        <input type="number" id="popupTextSizeInput" min="10" max="100">
    </div>
    <div style="margin-bottom: 10px;">
        <select id="popupFontWeightSelect" style="padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
            <option value="normal">Normal</option>
            <option value="bold">Bold</option>
        </select>
    </div>
    <div style="margin-bottom: 10px;">
        <select id="popupFontFamilySelect" style="padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
            <option value="Nanum Gothic">Nanum Gothic</option>
            <option value="Noto Sans KR">Noto Sans KR</option>
            <option value="Do Hyeon">Do Hyeon</option>
            <option value="Gugi">Gugi</option>
            <option value="Noto Sans KR">Noto Sans KR</option>
            <option value="Black Han Sans">Black Han Sans</option>
            <option value="Gamja Flower">Gamja Flower</option>
            <option value="Dokdo">Dokdo</option>
            <option value="Sunflower">Sunflower</option>
            <option value="Poor Story">Poor Story</option>
        </select>
    </div>
    <button id="updateTextButton">업데이트</button>
    <button id="closeTextPopup" style="  margin-top: 15px;
        width: 100%;
        padding: 10px;
        background-color: red;
       border: none;
        border-radius: 5px;
        color: #fff;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s ease; /* 추가: 호버 효과 */
        ">닫기
    </button>
</div>

<!-- 빈사각형 지정 팝업 -->
<div id="colorPopup" class="popup3">
    <div class="popup3-content">
        <span id="closeColorPopup" class="close">
            <i class="fas fa-times"></i>
        </span>
        <!--<span id="closeColorPopup" class="close">X</span>-->
        <h3 style="font-family: 'Noto Sans KR', sans-serif; padding-left: 5px; margin-bottom: 15px; font-weight:bold;">
            <i class="far fa-square" style="margin-right: 5px; "></i>
            빈사각형 색깔
        </h3>
        <div class="color-palette" style="margin-bottom: 15px;">
            <div class="color-circle" style="background-color: #FF0000; margin-right: 35px;" data-color="#FF0000"></div>
            <div class="color-circle" style="background-color: #00FF00; margin-right: 35px;" data-color="#00FF00"></div>
            <div class="color-circle" style="background-color: #0000FF; margin-right: 35px;" data-color="#0000FF"></div>
            <div class="color-circle" style="background-color: #FFFF00; margin-right: 35px;" data-color="#FFFF00"></div>
            <div class="color-circle rainbow-circle" id="rainbowCircle1">  </div> <!-- 무지개 버튼 -->
            <!-- 기본 색상 선택기 (투명하게 처리) -->
            <input type="color" id="rectColorPicker" class="color-picker-transparent">
        </div>
        <button class="rect_button" id="updateColorButton">변경</button>
    </div>
</div>

<!-- 색채운 사각형 지정 팝업 -->
<div id="colorPopup2" class="popup4">
    <div class="popup4-content">
        <span id="closeColorPopup2" class="close2">
            <i class="fas fa-times"></i>
        </span>
        <!--<span id="closeColorPopup2" class="close2">X</span>-->
        <h3 style="font-family: 'Noto Sans KR', sans-serif; padding-left: 5px; margin-bottom: 15px; font-weight:bold;">
            <i class="fas fa-square" style="margin-right: 5px; font-weight:bold;"></i>
            사각형 색깔
        </h3>
        <!-- 색상 팔레트 추가 -->
        <div class="color-palette" style="margin-bottom: 15px;">
            <div class="color-circle" style="background-color: #FF0000; margin-right: 35px;" data-color="#FF0000"></div>
            <div class="color-circle" style="background-color: #00FF00; margin-right: 35px;" data-color="#00FF00"></div>
            <div class="color-circle" style="background-color: #0000FF; margin-right: 35px;" data-color="#0000FF"></div>
            <div class="color-circle" style="background-color: #FFFF00; margin-right: 35px;" data-color="#FFFF00"></div>
            <div class="color-circle rainbow-circle" id="rainbowCircle2">  </div> <!-- 무지개 버튼 -->
            <!-- 기본 색상 선택기 (투명하게 처리) -->
            <input type="color" id="rectColorPicker2" class="color-picker-transparent">
        </div>
        <button class="rect_button2" id="updateColorButton2">변경</button>
    </div>
</div>


<!-- 펜 색깔 지정 팝업 -->
<div id="colorPopup3" class="popup5">
    <div class="popup5-content">
        <span id="closeColorPopup3" class="close3">
            <i class="fas fa-times"></i>
        </span>
        <h3 style="font-family: 'Noto Sans KR', sans-serif; padding-left: 5px; margin-bottom: 15px; font-weight:bold;">
            <i class="fas fa-paint-brush" style="margin-right: 5px;"></i>
            펜 색상
        </h3>
        <!-- 색상 팔레트 추가 -->
        <div class="color-palette" style="margin-bottom: 15px;">
            <div class="color-circle" style="background-color: #FF0000; margin-right: 35px;" data-color="#FF0000"></div>
            <div class="color-circle" style="background-color: #00FF00; margin-right: 35px;" data-color="#00FF00"></div>
            <div class="color-circle" style="background-color: #0000FF; margin-right: 35px;" data-color="#0000FF"></div>
            <div class="color-circle" style="background-color: #FFFF00; margin-right: 35px;" data-color="#FFFF00"></div>
            <div class="color-circle rainbow-circle" id="rainbowCircle3">  </div> <!-- 무지개 버튼 -->
            <!-- 기본 색상 선택기 (투명하게 처리) -->
            <input type="color" id="rectColorPicker3" class="color-picker-transparent">
        </div>
        <button class="rect_button3" id="updateColorButton3">변경</button>
    </div>
</div>


<!-- 이미지 및 오디오 저장 모달 -->
<div id="popup5" class="popup5">
    <div class="popup-content5">
        <span id="close5" class="close-btn5">&times;</span>
        <h3 style="font-family: 'Noto Sans KR', sans-serif; font-weight:bold;">
            <i class="fas fa-download" style="margin-right: 5px;"></i> 다운로드
        </h3>
        <form id="popup-form5" style="margin-top: 10px">
            <label style="font-size: 22px;">
                <input type="checkbox" name="options5" value="image" style="width: 17px; height: 17px;">
                카드뉴스
            </label>
            <label style="font-size: 22px;">
                <input type="checkbox" name="options5" value="audio" style="width: 17px; height: 17px;">
                TTS
            </label>
            <label style="font-size: 22px;">
                <input type="checkbox" name="options5" value="video" style="width: 17px; height: 17px;">
                동영상
            </label>
            <div class="button-group5">
                <button type="submit" class="btn download-btn5" style="width: 135px;">Download</button>
                <button type="button" id="cancel5" class="btn cancel-btn5" style="width: 135px;">Cancel</button>
            </div>
        </form>
    </div>
</div>

<div id="overlay5"></div>
<div id="filterPopup5">
    <h3 style="font-family: 'Noto Sans KR', sans-serif; padding-left: 10px; font-weight:bold;">
        <i class="fas fa-camera-retro fa-lg" style="margin-right: 8px; font-size: 24px;"></i>필터 선택
    </h3>
    <form id="filterForm5">
        <div class="filter-option5">
            <input type="radio" id="blur5" name="filter5" value="blur">
            <label for="blur5">흐리게</label>
        </div>
        <div class="filter-option5">
            <input type="radio" id="brighten5" name="filter5" value="brighten">
            <label for="brighten5">밝게</label>
        </div>
        <div class="filter-option5">
            <input type="radio" id="contrast5" name="filter5" value="contrast">
            <label for="contrast5">대비 조정</label>
        </div>
        <div class="filter-option5">
            <input type="radio" id="grayscale5" name="filter5" value="invert">
            <label for="grayscale5">흑백</label>
        </div>
        <div class="filter-option5">
            <input type="radio" id="sepia5" name="filter5" value="sepia">
            <label for="sepia5">세피아</label>
        </div>
        <div class="filter-option5">
            <input type="radio" id="default" name="filter5" value="default">
            <label for="default">없음</label>
        </div>
    </form>
    <div id="buttonWrapper5">
        <button id="applyFilter5">적용</button>
        <button id="closePopup5">닫기</button>
    </div>
</div>

<div class="overlay-container">
    <div>이미지를 생성 중입니다. 잠시만 기다려주세요...</div>
    <div id="time">00:40</div>
</div>

<div class="popup-background150">
    <!-- 팝업 컨테이너 -->
    <div class="popup-container150">
        <!-- 상단 중앙에 문의 문구 추가 -->
        <div class="inquiry-text150">
            <a href="/chat" style="color: black; text-decoration: none; font-weight: bold; font-size: large;">
                ⭐문의하실게 있으면 이 문구를 클릭!⭐
            </a>
        </div>


        <!-- 페이지 1 -->
        <div class="page150 active150" id="page-1150">
            <div class="page-content150" style="background-image: url('/info/img1.png');">
                <div class="page-text150" style="font-weight: bold;">환영합니다! 이 설명서는 사용법을 안내해 드립니다!</div>
            </div>
        </div>
        <!-- 페이지 2 -->
        <div class="page150" id="page-2150">
            <div class="page-content150" style="background-image: url('/info/img2.png');">

            </div>
        </div>
        <!-- 페이지 3 -->
        <div class="page150" id="page-3150">
            <div class="page-content150" style="background-image: url('/info/img3.png');">

            </div>
        </div>

        <div class="page150" id="page-4150">
            <div class="page-content150" style="background-image: url('/info/img4.png');">

            </div>
        </div>

        <div class="page150" id="page-5150">
            <div class="page-content150" style="background-image: url('/info/img5.png');">

            </div>
        </div>

        <div class="page150" id="page-6150">
            <div class="page-content150" style="background-image: url('/info/img6.png');">

            </div>
        </div>

        <div class="page150" id="page-7150">
            <div class="page-content150" style="background-image: url('/info/img7.png');">

            </div>
        </div>

        <div class="page150" id="page-8150">
            <div class="page-content150" style="background-image: url('/info/img8.png');">

            </div>
        </div>

        <div class="page150" id="page-9150">
            <div class="page-content150" style="background-image: url('/info/img9.png');">

            </div>
        </div>

        <div class="page150" id="page-10150">
            <div class="page-content150" style="background-image: url('/info/img10.png');">

            </div>
        </div>

        <div class="page150" id="page-11150">
            <div class="page-content150" style="background-image: url('/info/img11.png');">

            </div>
        </div>

        <div class="page150" id="page-12150">
            <div class="page-content150" style="background-image: url('/info/img11-2.png');">

            </div>
        </div>

        <div class="page150" id="page-13150">
            <div class="page-content150" style="background-image: url('/info/img12.png');">

            </div>
        </div>

        <div class="page150" id="page-14150">
            <div class="page-content150" style="background-image: url('/info/img13.png');">

            </div>
        </div>

        <div class="page150" id="page-15150">
            <div class="page-content150" style="background-image: url('/info/img14.png');">

            </div>
        </div>

        <!-- 닫기 버튼 -->
        <button class="close-button150" id="closeButton150">X</button>

        <!-- 이전 버튼 -->
        <button class="button150 prev150" id="prevButton150">이전</button>
        <!-- 다음 버튼 -->
        <button class="button150 next150" id="nextButton150">다음</button>

        <!-- 페이지 번호 표시 -->
        <div class="page-indicator150" style="color: red; font-weight: bold;" id="pageIndicator150">1/15</div>
    </div>
</div>

<!-- HTML: Loading Overlay -->
<div id="loadingOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); color: white;
 justify-content: center; align-items: center; z-index: 9999;">
    <div class="center-block">

        <canvas id="canvas2"> <!-- canvas는 그림, 이미지를 그릴 수 있게하는 태그 -->
        </canvas>
        <span style="position: absolute; top: 45%; left: 50%; transform: translateX(-50%); color: black; font-weight: bold">
        ⬆️ 방향키를 누르면서 장애물을 피하세요!
            </span>
    </div>
</div>

<script src="/js/main.js"></script>


<script src="/js/app.js"></script>
<script>

    // 이미지 저장 함수
    function saveImage() {
        var canvas = document.getElementById("imageCanvas");
        var imageData = canvas.toDataURL("image/png");

        document.getElementById("imageData").value = imageData;
        document.getElementById("imageForm").submit();

        const canvasState = {
            backgroundImage: backgroundImage ? backgroundImage.src : null,
            penStrokes: penStrokes,
            brushStrokes: brushStrokes,
            texts: texts,
            rectangles: rectangles,
            rectfillangles: rectfillangles,
            backgroundColor: backgroundColor,
            currentFilter: filterLastValue,

        };
        const json = JSON.stringify(canvasState);

        // 서버로 JSON 데이터 전송
        if (json) { // null 체크
            fetch('/ai-Json', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: json
            })
                .then(response => {
                    // 서버 응답 처리
                })
                .catch(error => {
                    // 오류 처리
                });
        }
    }
</script>
<script>
    const categoryButton = document.getElementById('category');

    const returnButton = document.getElementById('square');
    const popup = document.getElementById('popup');

    categoryButton.addEventListener('click', (event) => {


        const rect = returnButton.getBoundingClientRect();
        const rightEdge = window.innerWidth;
        popup.style.top = `${rect.bottom}px`;
        if (rect.right + popup.offsetWidth > rightEdge) {
            popup.style.left = `${rect.left}px`;
        } else {
            popup.style.left = `${rect.right}px`;
        }
        togglePopup();
    });

    function togglePopup() {
        popup.style.display = (popup.style.display === 'block') ? 'none' : 'block';
    }

    document.addEventListener('click', (event) => {
        if (!popup.contains(event.target) && event.target !== categoryButton) {
            popup.style.display = 'none';
        }
    });

</script>

<script>
    const textButton = document.getElementById('textbutton');
    const color_tool = document.getElementById('text_color');
    const popup1 = document.getElementById('popup1');

    textButton.addEventListener('click', (event) => {
        const rect = color_tool.getBoundingClientRect();
        const rightEdge = window.innerWidth;
        popup1.style.top = `${rect.bottom}px`;
        popup1.style.left = `${rect.left - popup1.offsetWidth - 180}px`; // 수정된 부분: 왼쪽에 뜨도록 계산
        togglePopup1();
    });

    function togglePopup1() {
        popup1.style.display = (popup1.style.display === 'block') ? 'none' : 'block';
    }

    document.addEventListener('click', (event) => {
        if (!popup1.contains(event.target) && event.target !== textButton) {
            popup1.style.display = 'none';
        }
    });

</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    let interval; // 타이머 인터벌을 저장할 전역 변수
    let isTimerRunning = false; // 타이머 동작 여부를 확인할 변수

    function startTimer(duration, display) {
        let timer = duration, minutes, seconds;

        if (interval) {
            clearInterval(interval); // 이전 타이머 정지
        }

        interval = setInterval(function () {
            isTimerRunning = true; // 타이머가 동작 중임을 표시
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = minutes + ":" + seconds;

            if (--timer < 0) {
                clearInterval(interval);
                display.textContent = "00:00";
                isTimerRunning = false; // 타이머가 끝났음을 표시
            }
        }, 1000);
    }

    $(document).ready(function () {
        let timeDisplay = $("#time");
        let duration = 40; // 40초
        let textList = []; // 텍스트 리스트 저장 변수
        let textIndex = 0; // 현재 텍스트 인덱스

        // 이미지 생성 버튼 클릭
        $("#imageButton").click(function () {
            // 타이머가 이미 실행 중이 아니라면 타이머 시작
            if (!isTimerRunning) {
                startTimer(duration, timeDisplay[0]);
            }

            // 오버레이 표시
            $(".overlay-container").css("display", "flex");

            // AJAX 요청 보내기
            $.ajax({
                type: "POST",
                url: "/image-create",
                data: {
                    "prompt": $("#imageCreate").val()
                },
                success: function (data) {
                    // JSON 응답 데이터 처리
                    if (data.imagePath) {
                        setBackgroundImage(data.imagePath);
                    }
                    if (data.message) {
                        $("#textInput").val(data.message);

                        textList = data.text; // 서버에서 받은 텍스트 리스트 저장

                        textIndex = 0; // 인덱스 초기화
                        addFilledSquare(100, 100);
                        // addTextToCanvas 함수 호출
                        addTextToCanvas();
                    }
                },
                error: function (xhr, status, error) {
                    alert("이미지 생성 중 오류가 발생했습니다.");
                    console.log(xhr.responseText);
                    // 1초 후에 페이지 새로고침
                    setTimeout(function () {
                        location.reload();
                    }, 1000);
                },
                complete: function () {
                    // 오버레이 숨김
                    $(".overlay-container").hide();
                }
            });
        });

        // 텍스트 추가 버튼 처리
        $("#addTexTAIButton2").click(function () {
            if (textList.length > 0) {
                if (textIndex < textList.length) {
                    $("#textInput").val(textList[textIndex]); // 텍스트 출력
                    textIndex++;
                    if (textIndex >= textList.length) {
                        textIndex = 0; // 인덱스를 처음으로 리셋
                    }
                }
            } else {
                $("#textInput").val("사용할 수 있는 AI 문구가 없습니다.");
            }
        });
    });



</script>

<script>
    function addFilledSquare(x, y) {
        const lineWidth = ctx.lineWidth * 20; // Adjust size as needed
        const rect = {
            x: 10,
            y: 600,
            width: 720,
            height: lineWidth,
            color: 'white',
            lineWidth: ctx.lineWidth
        };
        rectfillangles.push(rect);
        redrawCanvas();
    }
</script>


<script>
    document.getElementById('save5').addEventListener('click', function() {
        document.getElementById('popup5').style.display = 'flex';
    });

    document.getElementById('close5').addEventListener('click', function() {
        document.getElementById('popup5').style.display = 'none';
    });

    document.getElementById('cancel5').addEventListener('click', function() {
        document.getElementById('popup5').style.display = 'none';
    });

    document.getElementById('popup-form5').addEventListener('submit', function(event) {
        event.preventDefault();

        document.getElementById('popup5').style.display = 'none';
    });
</script>

<script>
    // 펜 색깔 지정 팝업을 드래그할 수 있도록 하는 함수
    function dragElement(element) {
        var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

        element.onmousedown = function (e) {
            e = e || window.event;
            e.preventDefault();
            // 마우스 시작 좌표 기록
            pos3 = e.clientX;
            pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            document.onmousemove = elementDrag;
        };

        function elementDrag(e) {
            e = e || window.event;
            e.preventDefault();
            // 마우스 움직임에 따른 팝업의 새 좌표
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;
            // 팝업 위치 업데이트
            element.style.top = (element.offsetTop - pos2) + "px";
            element.style.left = (element.offsetLeft - pos1) + "px";
        }

        function closeDragElement() {
            // 마우스 버튼을 떼면 드래그 중지
            document.onmouseup = null;
            document.onmousemove = null;
        }
    }

    // 팝업창을 드래그 가능하게 만듭니다.
    dragElement(document.querySelector(".popup5"));
    dragElement(document.querySelector(".popup3"));  // 사각형 색깔 팝업
    dragElement(document.querySelector(".popup4"));  // 색채운 사각형 팝업
    dragElement(document.querySelector("#filterPopup5"));  // 필터 선택 팝업
</script>

<script>
    // 빈사각형 무지개 버튼 클릭 시 색상 선택기 투명도를 없앰
    document.getElementById('rainbowCircle1').addEventListener('click', function() {
        const colorPicker = document.getElementById('rectColorPicker');
        colorPicker.style.opacity = '1';  // 투명도 없앰
        colorPicker.click();  // 기본 색상 선택기 창을 바로 열기
    });
    // 색채운 사각형 무지개 버튼 클릭 시 색상 선택기 투명도를 없앰
    document.getElementById('rainbowCircle2').addEventListener('click', function() {
        const colorPicker = document.getElementById('rectColorPicker2');
        colorPicker.style.opacity = '1';  // 투명도 없앰
        colorPicker.click();  // 기본 색상 선택기 창을 바로 열기
    });

    // 펜 색깔 지정 팝업 무지개 버튼 클릭 시 색상 선택기 투명도를 없앰
    document.getElementById('rainbowCircle3').addEventListener('click', function() {
        const colorPicker = document.getElementById('rectColorPicker3');
        colorPicker.style.opacity = '1';  // 투명도 없앰
        colorPicker.click();  // 기본 색상 선택기 창을 바로 열기
    });

</script>

<script>
    let currentPage150 = 1;
    const totalPages150 = 15;

    const prevButton150 = document.getElementById('prevButton150');
    const nextButton150 = document.getElementById('nextButton150');
    const closeButton150 = document.getElementById('closeButton150');
    const pages150 = document.querySelectorAll('.page150');
    const pageIndicator150 = document.getElementById('pageIndicator150');
    const popupBackground150 = document.querySelector('.popup-background150');

    function updatePage150(direction) {
        // 현재 페이지 숨기기
        const currentElement150 = document.getElementById(`page-${currentPage150}150`);
        currentElement150.classList.remove('active150');

        // 페이지 변경
        if (direction === 'next') {
            currentPage150 = currentPage150 < totalPages150 ? currentPage150 + 1 : 1;
        } else if (direction === 'prev') {
            currentPage150 = currentPage150 > 1 ? currentPage150 - 1 : totalPages150;
        }

        // 새 페이지 보여주기
        const nextElement150 = document.getElementById(`page-${currentPage150}150`);
        nextElement150.classList.add('active150');

        // 페이지 번호 업데이트
        pageIndicator150.textContent = `${currentPage150}/${totalPages150}`;

        // 마지막 페이지일 때 버튼 텍스트 변경
        if (currentPage150 === totalPages150) {
            nextButton150.textContent = '닫기';
            nextButton150.removeEventListener('click', nextClickHandler);
            nextButton150.addEventListener('click', () => popupBackground150.style.display = 'none');
        } else {
            nextButton150.textContent = '다음';
            nextButton150.removeEventListener('click', closePopupHandler);
            nextButton150.addEventListener('click', nextClickHandler);
        }
    }

    function nextClickHandler() {
        updatePage150('next');
    }

    function closePopupHandler() {
        popupBackground150.style.display = 'none';
    }

    nextButton150.addEventListener('click', nextClickHandler);
    prevButton150.addEventListener('click', () => updatePage150('prev'));
    closeButton150.addEventListener('click', closePopupHandler);
    // Info 버튼 클릭 시 팝업 보여주기
    const infoButton = document.getElementById('info');

    infoButton.addEventListener('click', () => {
        popupBackground150.style.display = 'flex'; // 팝업을 보여줌
    });

</script>



</body>

</html>
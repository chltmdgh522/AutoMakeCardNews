<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>A.M.C.N</title>
    <link rel="shortcut icon" href="/logo/logo2.png" type="image/x-icon">
    <!-- Custom fonts for this template-->
    <script src="https://kit.fontawesome.com/097a6f4f17.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <!-- Quill CSS 파일을 포함합니다. -->
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet"/>

    <!-- Include the Quill library -->
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>

    <!-- Custom styles for this template-->
    <link href="/css/sb-admin-2.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <style>

        a {
            text-decoration: none;
        }

        a:hover {
            text-decoration: none;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
            z-index: 1;
        }

        .dropdown-menu a, .dropdown-menu form {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-menu a:hover, .dropdown-menu form:hover {
            background-color: #f1f1f1;
        }

        .dropdown:hover .dropdown-menu {
            display: block;
        }

        .dropdown-menu form {
            margin: 0;
        }

        /* 폼 스타일 */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: .5rem;
        }

        textarea {

            /* 원하는 높이로 조정 */
            resize: none;
            /* 사용자가 크기 조절하지 못하도록 설정 */
            width: 100%;
            padding: .375rem .75rem;
            font-size: 1rem;
            border: none;
        }

        .form-group input[type="text"],
        .form-group textarea {
            width: 100%;
            padding: .375rem .75rem;
            font-size: 1rem;
            border: none;
            border-radius: .25rem;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        .form-group textarea {

            /* 원하는 높이로 조정 */
            resize: none;
            /* 사용자가 크기 조절하지 못하도록 설정 */
        }

        /* input, textarea 포커스 시 그림자 제거 */
        input:focus,
        textarea:focus,
        button:focus,
        button:active {
            outline: none;
            box-shadow: none !important;
        }

        /* form 태그에 포커스 시 그림자 제거 */
        form:focus-within {
            box-shadow: none !important;
        }

        /* 추가적인 스타일링을 원하는 경우 여기에 추가 */
    </style>
</head>

<body id="page-top">

<!-- Page Wrapper -->
<div id="wrapper" th:object="${member}">
    <div th:replace="~{header/header1 :: copyParam (${member})}"></div>


    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <div th:replace="~{header/header2 :: copyParam (${member})}"></div>
            <!-- header -->

            <!-- End of Topbar -->
            <div style="background-color: white;">
                <!-- Begin Page Content -->
                <div class="container-fluid" id="contnet">

                    <div class="container" style="padding-top: 20px;">
                        <div class="col-md-12">

                            <div style="display: flex; justify-content: space-between; margin-left: 5px; align-items: center; width: 100%;">
                                <div style="display: flex; align-items: center;">
                                    <div>
                                        <span style="font-size: 15px; font-weight: 600; color: gray;">&nbsp;카테고리&nbsp;&nbsp;</span>
                                    </div>
                                    <div>
                                        <i class="fas fa-greater-than" style="font-size: 14px;">&nbsp;</i>
                                    </div>
                                    <div>
                                        <span style="font-size: 15px; font-weight: 600; color: gray;"
                                              th:text="${board.category}">&nbsp;스포츠</span>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; margin-right: 15px;">
                                    <a href="/community/more"
                                       style="font-size: 19px; font-weight: 600; color: gray; text-decoration: none; display: flex; align-items: center; transition: color 0.3s, text-decoration 0.3s;"
                                       onmouseover="this.style.color='black'; this.style.textDecoration='underline';"
                                       onmouseout="this.style.color='gray'; this.style.textDecoration='none';">
                                        <i class="fas fa-list" style="margin-right: 5px;"></i> 전체글 보기
                                    </a>
                                </div>
                            </div>

                            <div>
                                    <textarea th:text="${board.title}" style="font-size: 30px; font-weight: 600;
                                                                  color: black;" class="dynamic-textarea" rows="1">&nbsp;Test
                                        제목</textarea>
                            </div>
                            <div style="margin-left: 10px;">
                            </div>
                            <div style="display: flex; margin-left: 9px; margin-top: 9px;">

                                <div class="icon">
                                        <span th:text="${board.member.name}"
                                              style="font-size: 12px; font-weight: 600; color: black;">&nbsp;
                                            최승호 |</span>

                                    <span th:text="${board.createdDate}"
                                          style="font-size: 13px; font-weight: 600; color: black;">&nbsp;2024.01.11&nbsp;</span>
                                </div>
                                <div class="icon" style="margin-left: 10px;">
                                    <i class="far fa-eye visitor-icon" style="color: black;"></i> <!-- 방문자 아이콘 -->
                                    <span style="font-size: 13px; font-weight: 600; color: black;"
                                          th:text="${board.viewCount}">3&nbsp;</span>
                                </div>
                                <div class="icon" style="margin-left: 10px;">
                                    <i class="far fa-comment" style="color: black;"></i> <!-- 댓글 아이콘 -->
                                    <span style="font-size: 13px; font-weight: 600; color: black;"
                                          th:text="${listComment.size()}">3&nbsp;</span>
                                </div>
                                <div style="display: flex; margin-left: 10px;"
                                     th:if="${member.memberId == board.member.memberId}">
                                    <div class="dropdown" style="position: relative;">
                                        <button class="btn btn-secondary dropdown-toggle1" type="button"
                                                id="dropdownMenuButton" aria-expanded="false"
                                                style="background-color: white; border-color: #cccccc; color: black; width: 160px;"
                                                title="더보기">
                                            <span> <i class="fas fa-cog"></i></span>
                                        </button>
                                        <ul class="dropdown-menu menu2" aria-labelledby="dropdownMenuButton"
                                            style="font-size: 12px;">
                                            <li><a class="dropdown-item"
                                                   th:href="@{/community/edit/{id}(id=${board.boardId})}"
                                                   style="font-weight: bold;">수정</a></li>
                                            <li>
                                                <form id="deleteForm"
                                                      th:action="@{/community/delete/{id}(id=${board.boardId})}"
                                                      method="POST">
                                                    <button type="submit" class="dropdown-item" style="font-weight: bold; background: none; border: none;
                                                    padding: 0; cursor: pointer; color: red;">삭제
                                                    </button>
                                                </form>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                            </div>


                            <hr>
                            <div style="margin-left: 14px;   color: black;">
                                <div class="post-content">
                                    <div th:utext="${board.substance}" class="dynamic-textarea ql-editor"
                                         style="overflow: hidden;"
                                    >
                                        여기에는 게시글의 내용이 들어갑니다. Lorem ipsum dolor sit amet, consectetur adipiscing
                                        elit.
                                        Nulla vitae nisi nec est pulvinar congue non non enim. Curabitur interdum
                                        justo a nulla convallis,
                                        quis pharetra magna eleifend. Vestibulum ante ipsum primis in faucibus orci
                                        luctus et ultrices posuere
                                        cubilia Curae; Nam venenatis augue ac velit pharetra, sed varius elit
                                        ultrices. Proin euismod ut odio
                                        at elementum. Donec quis nunc consequat, tempus urna et, aliquam arcu. In
                                        eget ligula vitae erat rhoncus
                                        venenatis eget et justo. Nulla facilisi. Ut id mauris auctor, sollicitudin
                                        leo nec, ullamcorper leo.
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; margin-left: 9px; margin-top: 9px;">


                                <div class="icon" id="likes" name="likes" style="margin-left: 8px; cursor: pointer;">
                                    <i id="likeIcon"
                                       th:class="${boardlikes == 'O'} ? 'far fa-thumbs-up like-icon' : 'fas fa-thumbs-up like-icon'"
                                       style="color: black"></i>
                                    <span style="font-size: 13px; font-weight: 600; color: black;" id="boardLike2"
                                          th:text="${boardLike}">3&nbsp;</span>
                                </div>
                                <div class="icon" style="margin-left: 10px;">
                                    <i class="far fa-comment" style="color: black;"></i> <!-- 댓글 아이콘 -->
                                    <span style="font-size: 13px; font-weight: 600; color: black; "
                                          th:text="${listComment.size()}">3&nbsp;</span>
                                </div>

                            </div>
                            <hr>
                            <div class="ml-3">
                                <h6 style="color: black;" th:text="|댓글 ${listComment.size()}|">댓글 3</h6>
                                <form th:action="@{/comment/{id}(id=${board.boardId})}" th:object="${comment}"
                                      method="post">
                                    <div class="input-group">
                                        <textarea class="form-control custom-textarea" style=" border: 1px solid black;  border-radius: 8px;

                                        padding: .375rem .75rem;" rows="2"
                                                  placeholder="댓글을 입력하세요" required th:field="*{substance}" ></textarea>
                                        <div class="input-group-append" style="margin-left: 5px;">
                                            <button type="submit" class="btn btn-dark">댓글 남기기</button>
                                        </div>
                                    </div>
                                </form>
                            </div>

                            <div class="container mt-1" style="margin-right: 50px;" th:each="list : ${listComment}">

                                <li class="list-group-item border-0">
                                    <a style="color: black;">

                                        <div style="display: flex;">
                                            <div>
                                                <img th:src="|/my-page/image/${list.member.profile}|"
                                                     class="rounded-circle" style="color: black;"
                                                     width="30"
                                                     height="30"/>
                                            </div>
                                            <div style="margin: 10px;">
                                                    <span style="font-size: 13px; font-weight: 600; color: black;"
                                                          th:text="${list.member.name}">최승호
                                                        &nbsp;</span>
                                            </div>
                                            <div style="margin: 10px -10px;"
                                                 th:if="${list.member.memberId == board.member.memberId}">
                                                    <span style="font-size: 13px; font-weight: 600; color: red;">&nbsp; 작성자
                                                        &nbsp;</span>
                                            </div>

                                        </div>
                                    </a>
                                    <div class="mt-2"></div>
                                    <textarea style="font-weight: bold; color: black;" th:text="${list.substance}"
                                              class="dynamic-textarea" rows="1" readonly>안녕하세요 반가워요</textarea>
                                    <div class="icon">
                                        <i class="far fa-clock" style="color: black;"></i> <!-- 시간 아이콘 -->
                                        <span
                                                style="font-size: 13px; font-weight: 600; color: black;"
                                                th:text="${list.date}">&nbsp;2024.01.11&nbsp;</span>


                                        <a th:if="${member.memberId == list.member.memberId}"
                                           style="font-size: 13px; font-weight: 600; color: red; cursor: pointer; "
                                           th:attr="data-comment-id=${list.commentId}"
                                           class="delete-comment">삭제</a>
                                    </div>
                                </li>
                                <hr style="border: 1px solid #ccc; margin-top: 10px; margin-bottom: 10px;">
                            </div>

                            <div></div>
                            <div style="display: none">
                                <span id="boardId" name="boardId" th:text="${board.boardId}">1</span>
                            </div>
                            <button onclick="scrollToTop()" id="topBtn" title="Go to top"
                                    style="display: none; position: fixed; bottom: 20px; right: 20px; z-index: 99; font-size: 18px; border: none; outline: none; background-color: black; color: white; cursor: pointer; padding: 15px; border-radius: 10px; transition: background-color 0.3s;">
                                TOP
                            </button>
                        </div>
                    </div>
                </div>

            </div>


        </div>
    </div>
    <!-- End of Content Wrapper -->


</div>
<!-- End of Page Wrapper -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // 모든 '삭제' 링크에 클릭 이벤트 리스너를 추가
        document.querySelectorAll('.delete-comment').forEach(function (element) {
            element.addEventListener('click', function (event) {
                event.preventDefault();  // 기본 동작 막기

                // commentId 가져오기
                const commentId = this.getAttribute('data-comment-id');

                // POST 요청 보내기
                fetch(`/comment/delete/${commentId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({}) // 필요 시 데이터 추가
                })
                    .then(response => {
                        if (response.ok) {
                            // 서버에서 리다이렉트 URL을 JSON 형태로 받을 경우
                            return response.json(); // 응답을 JSON으로 처리
                        } else {
                            // 오류 처리
                            alert('댓글 삭제에 실패했습니다.');
                        }
                    })
                    .then(data => {
                        if (data && data.redirectUrl) {
                            // 서버에서 리다이렉트 URL을 제공받았을 때 해당 URL로 이동
                            window.location.href = data.redirectUrl;
                        } else {
                            // 기본적으로 현재 페이지 새로고침
                            window.location.reload();
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('서버와의 통신에 실패했습니다.');
                    });
            });
        });
    });

</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const dropdownButton = document.querySelector('.dropdown-toggle1');
        const dropdownMenu = document.querySelector('.dropdown-menu');
        const deleteForm = document.getElementById('deleteForm');

        dropdownButton.addEventListener('click', function (event) {
            event.stopPropagation();
            dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
        });

        document.addEventListener('click', function (event) {
            if (!dropdownButton.contains(event.target)) {
                dropdownMenu.style.display = 'none';
            }
        });

        deleteForm.addEventListener('submit', function (event) {
            if (confirm('정말 삭제하시겠습니까?')) {
                alert('삭제되었습니다.');
                // 실제 삭제 처리를 수행하는 코드 추가
            } else {
                alert('삭제가 취소되었습니다.');
            }
        });
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.6/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="js/sb-admin-2.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Swiper JS -->
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<!-- Initialize Swiper -->
<script>
    var bookIcon = document.getElementById('likeIcon');

    $(document).ready(function () {
        // 뉴스 스크랩
        $("#likes").click(function () {
            console.log("gd");
            $.ajax({
                type: "POST",
                url: "/board-like",
                data: {
                    "boardId": $("#boardId").text()
                },
                success: function (data) {
                    $("#boardLike2").text(data)
                    updateHeartIcon();
                }
            })
        });
    });

    function updateHeartIcon() {
        if (bookIcon.classList.contains('far')) {
            bookIcon.classList.remove('far');
            bookIcon.classList.add('fas');
            // 여기서 상태를 서버에 저장하거나 처리하는 로직을 추가할 수 있습니다.
        } else {
            bookIcon.classList.remove('fas');
            bookIcon.classList.add('far');
            // 여기서 상태를 서버에 저장하거나 처리하는 로직을 추가할 수 있습니다.
        }
    }

</script>
<script>
    function autoHeight(textarea) {
        textarea.style.height = 'auto'; // 높이를 초기화하여 콘텐츠에 맞게 조정할 준비
        textarea.style.height = `${textarea.scrollHeight}px`; // 콘텐츠에 맞게 높이 조정
    }

    // 페이지 로드 시 높이 조정
    window.addEventListener('load', function () {
        const textareas = document.getElementsByClassName('dynamic-textarea');
        for (let textarea of textareas) {
            autoHeight(textarea);
        }
    });

    // 사용자가 텍스트를 수정할 때 높이 조정
    document.addEventListener('input', function (event) {
        if (event.target.classList.contains('dynamic-textarea')) {
            autoHeight(event.target);
        }
    });

</script>

<script>
    // 페이지가 스크롤될 때 TOP 버튼 표시/숨기기
    window.onscroll = function () {
        scrollFunction()
    };

    function scrollFunction() {
        var topBtn = document.getElementById("topBtn");
        if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
            topBtn.style.display = "block"; // 스크롤이 100px 이상일 때 버튼을 보이게
        } else {
            topBtn.style.display = "none";  // 그 이하일 때 버튼을 숨김
        }
    }

    // TOP 버튼 클릭 시 페이지 상단으로 스크롤
    function scrollToTop() {
        document.body.scrollTop = 0; // Safari 브라우저에서 상단으로 스크롤
        document.documentElement.scrollTop = 0; // 크롬, 파이어폭스, IE 브라우저에서 상단으로 스크롤
    }
</script>

</body>

</html>